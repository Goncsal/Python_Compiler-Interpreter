# 2ºAno / 2ºSemestre / Compiladores / Projeto IML
---


**Grupo:** IML- b03  
**Elementos:**
- Ana Margarida Castro
- Filipe Marques
- Gonçalo Almeida
- João Barreira
- José Pedro Bagagem

# Relatório
## Introdução

Este projeto tem como objetivo a criação da linguagem de programação **IML** (*Image Manipulation Language*), uma linguagem compilada que permite a manipulação de imagens em tons de cinzento.


# Requisitos - Níveis Minimos, Desejáveis e Adicionais
## Mínimos e Desejáveis
### Linguagem Principal IML e Linguagem Secundária IIML
Foram atingidos com sucesso todos os objetivos (níveis) mínimos e desejáveis dados.
Gostavamos de realçar que na geração de código foi criado um exemplo (examples/newTests/example03.iml) que carrega uma imagem PGM e adiciona um valor mínimo a cada pixel para garantir que nenhum fique completamente a zero. Depois, num ciclo que só termina quando todos os pixéis atingem o valor máximo (1). Quando todos os pixéis ficam brancos, o processo acaba, demonstrando que não há “estouro” de intensidade: assim que se atinge a saturação total, deixa-se de aumentar o valor e evita-se qualquer overflow.
![Iluminação progressiva](examples/newTests/iluminado.gif)


## Adicionais
### Linguagem Principal IML - Features Adicionais
Implementámos o acesso a elementos de listas bidimensionais através de índices, no (examples/newTests/example08.iml). Usamos j[0] para obter a primeira sublista e "j[0][1]" para aceder ao segundo valor dessa linha. Funciona com imagens também.
### Comandos
```bash
./compile.sh ../examples/newTests/example08.iml
./run.sh     ../examples/newTests/run.py

Outcome:
[0.5 0.1]
0.1
[0.21568627 0.12941176 0.15294118 0.2627451  0.22352941 0.24705882
 0.24313725 0.29019608 0.37647059 0.40784314 0.42352941 0.37647059
 0.38823529 0.39607843 0.40784314 0.47843137 0.51764706 0.5372549
 0.54117647 0.54117647 0.50980392 0.55686275 0.50980392 0.48627451
 0.48627451 0.55686275 0.58431373 0.65882353 0.70588235 0.7254902
 0.71764706 0.60784314 0.64705882 0.69803922 0.65098039 0.69803922
 0.72941176 0.68235294 0.64705882 0.69803922 0.69803922 0.61960784
 0.63529412 0.67843137 0.68235294 0.65098039 0.67843137 0.67843137
 0.65490196 0.60392157 0.62745098 0.54117647 0.58431373 0.56470588
 0.55686275 0.61176471 0.58823529 0.63137255 0.63137255 0.65882353
 0.67843137 0.70196078 0.72156863 0.70588235 0.70196078 0.70196078
 0.64705882 0.68235294 0.7254902  0.65882353 0.68235294 0.63137255
 0.6745098  0.62745098 0.60392157 0.54117647 0.55686275 0.56470588
 0.51372549 0.54117647 0.54117647 0.55686275 0.51372549 0.51372549
 0.5372549  0.56470588 0.53333333 0.58431373 0.56470588 0.62745098
 0.61176471 0.60392157 0.59607843 0.61176471 0.56470588 0.56470588
 0.58431373 0.56470588 0.61176471 0.65882353 0.62745098 0.65098039
 0.71764706 0.74117647 0.74117647 0.75294118 0.75294118 0.77647059
 0.74509804 0.76862745 0.75294118 0.7254902  0.7254902  0.77254902
 0.69803922 0.72156863 0.72156863 0.65490196 0.70588235 0.69803922
 0.69411765 0.71764706 0.70196078 0.67058824 0.65490196 0.63137255
 0.59607843 0.63529412 0.60784314 0.63137255 0.65882353 0.60392157
 0.64705882 0.64705882 0.64705882 0.61176471 0.63529412 0.63137255
 0.64705882 0.6745098  0.63137255 0.64705882 0.64705882 0.60784314
 0.65882353 0.67843137 0.67058824 0.6745098  0.70196078 0.68235294
 0.62745098 0.60392157 0.67058824 0.70588235 0.6745098  0.67843137
 0.69803922 0.70196078 0.71764706 0.65882353 0.70588235 0.69411765
 0.78823529 0.70588235 0.74509804 0.69411765 0.67843137 0.63137255
 0.59607843 0.61176471 0.63137255 0.56470588 0.61960784 0.59607843
 0.65882353 0.6745098  0.56470588 0.51764706 0.43529412 0.51764706
 0.53333333 0.47058824 0.58431373 0.65490196 0.60784314 0.5254902
 0.56470588 0.6745098  0.60784314 0.65882353 0.62745098 0.67843137
 0.55686275 0.60784314 0.50980392 0.58431373 0.54117647 0.50980392
 0.61176471 0.58431373 0.63137255 0.5254902  0.57254902 0.51764706
 0.49019608 0.53333333 0.44705882 0.58039216 0.65490196 0.63137255
 0.50980392 0.58431373 0.61960784 0.51764706 0.60784314 0.47058824
 0.57254902 0.56470588 0.67058824 0.63529412 0.56470588 0.61176471
 0.63529412 0.69411765 0.65882353 0.64705882 0.56470588 0.63529412
 0.63529412 0.7254902  0.71764706 0.60784314 0.54901961 0.51764706
 0.54117647 0.61176471 0.60392157 0.68235294 0.74509804 0.81176471
 0.6745098  0.61176471 0.70588235 0.65098039 0.68235294 0.69411765
 0.67058824 0.68235294 0.65098039 0.7254902  0.7254902  0.65098039
 0.7254902  0.74509804 0.72941176 0.63529412 0.69803922 0.70588235
 0.79215686 0.7254902  0.72941176 0.80392157 0.74901961 0.65882353
 0.67843137 0.69803922 0.69803922 0.69803922 0.70196078 0.74901961
 0.71764706 0.70588235 0.70196078 0.72941176 0.75294118 0.70196078
 0.70588235 0.69803922 0.72156863 0.77254902 0.77647059 0.74509804
 0.81960784 0.76470588 0.70588235 0.75294118 0.75294118 0.70196078
 0.74509804 0.77647059 0.75294118 0.74509804 0.77254902 0.78823529
 0.79215686 0.79215686 0.74901961 0.74509804 0.72941176 0.72156863
 0.68235294 0.80392157 0.79607843 0.81568627 0.83529412 0.85098039
 0.81568627 0.80392157 0.78823529 0.80392157 0.81568627 0.83921569
 0.85882353 0.81960784 0.77254902 0.76862745 0.67843137 0.62745098
 0.61176471 0.59607843 0.68235294 0.76470588 0.77647059 0.81960784
 0.81176471 0.81960784 0.85098039 0.77254902 0.77647059 0.76862745
 0.74509804 0.77254902 0.71764706 0.79607843 0.71764706 0.65882353
 0.65490196 0.65882353 0.59607843 0.56470588 0.55686275 0.51372549
 0.50980392 0.53333333 0.55686275 0.48627451 0.50980392 0.51372549
 0.55686275 0.55686275 0.53333333 0.55686275 0.61176471 0.64705882
 0.63137255 0.63137255 0.61960784 0.63529412 0.6745098  0.63529412
 0.72156863 0.70196078 0.65882353 0.70196078 0.70196078 0.70588235
 0.67843137 0.74509804 0.72941176 0.69803922 0.71764706 0.74509804
 0.72941176 0.70196078 0.74509804 0.74509804 0.74509804 0.77647059
 0.78823529 0.76470588 0.70588235 0.68235294 0.74117647 0.63529412
 0.64705882 0.54117647 0.58039216 0.58431373 0.60784314 0.67843137
 0.69411765 0.71764706 0.72941176 0.70588235 0.69411765 0.69803922
 0.70588235 0.74117647 0.70196078 0.65490196 0.65098039 0.61176471
 0.60392157 0.59607843 0.56470588 0.58431373 0.57254902 0.55686275
 0.49411765 0.49019608 0.48627451 0.44705882 0.44313725 0.45882353
 0.47058824 0.45882353 0.48627451 0.49411765 0.58431373 0.56470588
 0.54901961 0.5254902  0.5254902  0.55686275 0.63137255 0.56470588
 0.58431373 0.58039216 0.58823529 0.59607843 0.63137255 0.62745098
 0.67058824 0.65882353 0.67058824 0.6745098  0.65882353 0.69803922
 0.69803922 0.65490196 0.65098039 0.67843137 0.68235294 0.63529412
 0.59607843 0.51764706 0.45882353 0.44313725 0.47058824 0.54901961
 0.55686275 0.60392157 0.63137255 0.65882353 0.63529412 0.68235294
 0.70588235 0.67843137 0.63529412 0.65490196 0.62745098 0.61176471
 0.65490196 0.61176471 0.60392157 0.62745098 0.56470588 0.61176471
 0.63529412 0.59607843 0.59607843 0.61176471 0.58431373 0.61960784
 0.56078431 0.54117647 0.61176471 0.58823529 0.60784314 0.61176471
 0.64705882 0.62745098 0.63529412 0.61960784 0.65882353 0.61176471
 0.65098039 0.63529412 0.60784314 0.69803922 0.69803922 0.65882353
 0.67843137 0.69803922 0.67843137 0.69803922 0.65882353 0.68235294
 0.70196078 0.65882353 0.67058824 0.67843137 0.69803922 0.65882353
 0.70196078 0.68235294 0.68235294 0.65882353 0.69803922 0.69411765
 0.68235294 0.67058824]

0.5137254901960784

```



Além disso, acrescentámos o método pop com o objetivo de remover sublistas completas, como no (examples/newTests/example07.iml)-" g pop [100%, 10%]" - procura exatamente aquela sublista em g e retira-a antes de guardar o resultado final.

```bash
./compile.sh ../examples/newTests/example07.iml
./run.sh     ../examples/newTests/run.py

Outcome 
[[0.1 1. ]]

```

Por fim, as operações aritméticas "pixel a pixel" também foram expandidas para suportar listas, sendo assim podemos, por exemplo, somar um número a todos os elementos de uma lista ou ainda somar duas listas de imagens, como demonstrado no exemplo abaixo.

![Resultado de example05.pgm](examples/images/blend.gif)

### Linguagem Secundária IIML - Features Adicionais
 - Programa para auxiliar o teste da linguagem secundária: run_iiml.py. Rodará o código existente de momento no ficheiro example.iiml
 - Foram adicionadas duas formas novas, para além das pedidas: Linhas e Estrelas.
 - Exemplos de **statements** de criação dessas são, respetivamente:
 - Linha: place line (450,50) (50,450) with thickness 8 with intensity 1
 - Estrela: place star 5 5 with thickness 1 with intensity 1
 - Para auxiliar na compreensão do código, foi decidido separar a lógica do analisador semântico do interpretador. Tendo em conta que esta é uma linguagem interpretada, não era necessário a separação e atenção especial dada a este analisador semântico. Entende-se isto então como uma feature adicional no desenvolvimento desta linguagem.


## Analisador Semântico

### Operações pixel a pixel

Em todas as operações pixel a pixel, suportamos operações entre imagens, listas de listas de números ou percentagens (também imagens), bem como outros elementos iteráveis que tenham a mesma profundidade e o mesmo tipo de elemento básico. Estas operações também são possíveis entre imagens ou elementos iteráveis e constantes (números ou percentagens).
Não suportamos listas que contenham booleanos ou strings nestas operações.

# Python_Compiler-Interpreter
